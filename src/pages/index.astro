---
import Layout from '../layouts/Layout.astro';
---

<Layout>
    <h1>ğŸ‰ğŸ‰ğŸ‰ <br> Â¡Feliz CumpleaÃ±os, Javi! ğŸ‚</h1>

    <img class="my-6" src="imagen.jpg" alt="Imagen de regalo">

    <p class="mb-6">
        âœ¨ Tu regalo estÃ¡ en camino... ğŸ <br>
        Adivina la frase correcta para recibir nuevas pistas.
    </p>

    <div id="puzzle-app">
        <input type="text" id="answerInput" placeholder="Escribe la pista aquÃ­" class="border p-2 rounded-xl">
        <button id="checkButton" class="ml-2 p-2 border-2 border-black text-black rounded-xl hover:bg-[#2d3436] hover:text-white cursor-pointer">Comprobar</button>

        <p id="hint" class="mt-4">Desencripta la pista: â™¡â˜€â™¥âœªâ™£â™¦â™¥ â–‘ â™£â™¦â™¥â™£â–²â™¦â–²â—†âœ§â™¡</p>
    </div>

    <script>
		document.addEventListener("DOMContentLoaded", () => {
			const hints = [
				"â™¡â˜€â™¥âœªâ™£â™¦â™¥â–‘â™£â™¦â™¥â™£â–²â™¦â–²â—†âœ§â™¡",
				"âœ¿âœ§â–‘â˜¾â–²â—â˜ƒâ–²âœ¿â–¢â–‘â™£â™¥â™¦âœ§â–‘â–²â– âœ©â˜¯â–²âœ¿",
				"â–²â˜˜â™¥âœ¿âœ©â˜¯â™¦â™¥â™¦âœ§â™¡â–‘â™¡â˜€â˜ƒâ™¥âœ¿â– â˜€âœ§â™¡âœ§â™¡",
				"â™¡âœ§âœªâ—â™¦â–²â™¡â–‘â™ â˜¯â™¥â–‘â–²â– âœ§âœªâ™£â–²â–³â–²âœ¿"
			];

			const correctPhrases = [
				"Siempre preparados",
				"No hablan, pero actÃºan",
				"Aventureros silenciosos",
				"Sombras que acompaÃ±an"
			];

			const regaloPalabra = "Zapatillas"; // palabra secreta del regalo

			let currentHint = 0;

			const hintEl = document.getElementById("hint");
			const inputEl = document.getElementById("answerInput") as HTMLInputElement | null;
			const buttonEl = document.getElementById("checkButton");

			if (!hintEl || !inputEl || !buttonEl) return;

			buttonEl.addEventListener("click", () => {
				const userAnswer = inputEl.value.trim();

				if(userAnswer === correctPhrases[currentHint]){
					currentHint++;
					if(currentHint < hints.length){
						const pistaAcertada = currentHint;
						const pistasRestantes = hints.length - currentHint;
						inputEl.value = "";
						hintEl.style.whiteSpace = "pre-line";
						hintEl.textContent =`ğŸŠ Â¡Has acertado la pista nÃºmero ${pistaAcertada}. Te quedan ${pistasRestantes}, Ã¡nimo!\nEsta es la siguiente pista:\n${hints[currentHint]}`;
					} else {
						hintEl.textContent = "ğŸŠ Â¡Has completado todas las pistas!";
						inputEl.style.display = "none";
						buttonEl.style.display = "none";

						// Creamos nuevo input y botÃ³n para adivinar el regalo
						const regaloDiv = document.createElement("div");
						regaloDiv.innerHTML = `
							<input type="text" id="regaloInput" placeholder="Â¿CuÃ¡l es tu regalo?" class="border p-2 rounded-xl">
							<button id="regaloButton" class="mt-6 ml-2 p-2 border-2 border-black text-black rounded-xl hover:bg-[#2d3436] hover:text-white cursor-pointer">Comprobar regalo</button>
							<p id="regaloHint" class="mt-4 text-lg font-semibold"></p>
						`;
						const puzzleApp = document.getElementById("puzzle-app");
						if (!puzzleApp) return;

						puzzleApp.appendChild(regaloDiv);

						const regaloInput = document.getElementById("regaloInput") as HTMLInputElement | null;
						const regaloButton = document.getElementById("regaloButton");
						const regaloHint = document.getElementById("regaloHint");

						if (regaloButton && regaloInput && regaloHint) {
							regaloButton.addEventListener("click", () => {
								if(regaloInput.value.trim().toLowerCase() === regaloPalabra.toLowerCase()){
									regaloHint.textContent = "ğŸ Â¡Correcto! Este es tu regalo:";
									const img = document.createElement("img");
									img.src = "zapatillas.png"; // ruta de la imagen de las zapatillas
									img.style.maxWidth = "100%"; // nunca se saldrÃ¡ del contenedor
									img.style.height = "auto";
									regaloDiv.appendChild(img);
									regaloInput.style.display = "none";
									regaloButton.style.display = "none";
								} else {
									regaloHint.textContent = "âŒ Incorrecto, intenta de nuevo.";
								}
							});
						}
					}
				} else {
					hintEl.style.whiteSpace = "pre-line";
					hintEl.textContent += `\nâŒ Frase incorrecta, intenta de nuevo.`;
				}
			});
		});
	</script>

</Layout>
